Dataset name: Tmall
The number of users: 8302
The number of items: 30316
The behavior ratings: [417483, 57409, 43172]
The number of ratings: 518064
Average actions of users: 62.40
Average actions of items: 17.09
The density of the dataset: 0.002058
The sparsity of the dataset: 99.794160%
wid : [0.1,0.1,0.1]
decay: 10.00
coefficient : [0.0/6, 5.0/6, 1.0/6]
already load adj matrix 0.11296200752258301
already load pre adj matrix
use the pre adjcency matrix
638
116
112
user_text_embs.shape: torch.Size([8302, 768])
self.num_users: 8302
without pretraining.
Epoch 0 [16.0s]: train==[805.09958=2.65956 + 156.41951 + 632.17999 + 13.84051]
Epoch 1 [15.5s]: train==[274.07224=0.43801 + 45.50759 + 214.88808 + 13.23855]
Epoch 2 [15.4s]: train==[139.28908=-0.01967 + 21.79762 + 101.27915 + 16.23199]
Epoch 3 [15.5s]: train==[119.08456=-0.07906 + 14.67862 + 87.39695 + 17.08805]
Epoch 4 [15.5s + 8.2s]:, recall=[0.00108, 0.00349], precision=[0.00011, 0.00007], hit=[0.00108, 0.00349], ndcg=[0.00050, 0.00100]
Epoch 5 [15.4s]: train==[107.34424=-0.13869 + 8.41842 + 83.17634 + 15.88817]
Epoch 6 [15.5s]: train==[103.68140=-0.15438 + 6.81904 + 82.23243 + 14.78431]
Epoch 7 [15.5s]: train==[100.88022=-0.16095 + 5.72274 + 81.59445 + 13.72399]
Epoch 8 [15.4s]: train==[98.91905=-0.16276 + 4.92673 + 81.26650 + 12.88858]
Epoch 9 [15.5s + 8.4s]:, recall=[0.00048, 0.00422], precision=[0.00005, 0.00008], hit=[0.00048, 0.00422], ndcg=[0.00035, 0.00113]
Epoch 10 [15.4s]: train==[96.09753=-0.14932 + 3.94844 + 80.48723 + 11.81119]
Epoch 11 [15.5s]: train==[95.03358=-0.13855 + 3.64157 + 80.01251 + 11.51805]
Epoch 12 [15.5s]: train==[94.26901=-0.12913 + 3.42348 + 79.66503 + 11.30963]
Epoch 13 [15.4s]: train==[93.57918=-0.12227 + 3.25339 + 79.27846 + 11.16960]
Epoch 14 [15.5s + 8.0s]:, recall=[0.00072, 0.00626], precision=[0.00007, 0.00013], hit=[0.00072, 0.00626], ndcg=[0.00033, 0.00147]
Epoch 15 [15.5s]: train==[92.48634=-0.11097 + 3.01213 + 78.66777 + 10.91740]
Epoch 16 [15.4s]: train==[92.39937=-0.10733 + 2.91440 + 78.78131 + 10.81100]
Epoch 17 [15.5s]: train==[91.77680=-0.10299 + 2.83691 + 78.35953 + 10.68334]
Epoch 18 [15.4s]: train==[91.60220=-0.10313 + 2.75998 + 78.37993 + 10.56542]
Epoch 19 [15.5s + 8.2s]:, recall=[0.00157, 0.00723], precision=[0.00016, 0.00014], hit=[0.00157, 0.00723], ndcg=[0.00075, 0.00191]
Epoch 20 [15.5s]: train==[90.84661=-0.09923 + 2.63046 + 77.98624 + 10.32913]
Epoch 21 [15.5s]: train==[90.46455=-0.09773 + 2.57790 + 77.78504 + 10.19934]
Epoch 22 [15.4s]: train==[90.14476=-0.09598 + 2.51706 + 77.63777 + 10.08591]
Epoch 23 [15.5s]: train==[89.73092=-0.09426 + 2.47060 + 77.38211 + 9.97247]
Epoch 24 [15.4s + 8.1s]:, recall=[0.00181, 0.00735], precision=[0.00018, 0.00015], hit=[0.00181, 0.00735], ndcg=[0.00102, 0.00218]
Epoch 25 [15.5s]: train==[89.00255=-0.09326 + 2.36452 + 76.95096 + 9.78033]
Epoch 26 [15.5s]: train==[88.82431=-0.09145 + 2.32040 + 76.93469 + 9.66066]
Epoch 27 [15.4s]: train==[88.42674=-0.09204 + 2.27948 + 76.70494 + 9.53437]
Epoch 28 [15.5s]: train==[88.21507=-0.09171 + 2.23135 + 76.63479 + 9.44064]
Epoch 29 [15.4s + 8.3s]:, recall=[0.00217, 0.00879], precision=[0.00022, 0.00018], hit=[0.00217, 0.00879], ndcg=[0.00113, 0.00253]
Epoch 30 [15.4s]: train==[87.92355=-0.09066 + 2.14947 + 76.59658 + 9.26816]
Epoch 31 [15.5s]: train==[87.70380=-0.08949 + 2.11293 + 76.50873 + 9.17163]
Epoch 32 [15.4s]: train==[87.29683=-0.08976 + 2.07014 + 76.23437 + 9.08209]
Epoch 33 [15.5s]: train==[87.12141=-0.09029 + 2.03498 + 76.18035 + 8.99638]
Epoch 34 [15.5s + 8.2s]:, recall=[0.00253, 0.00831], precision=[0.00025, 0.00017], hit=[0.00253, 0.00831], ndcg=[0.00122, 0.00242]
Epoch 35 [15.4s]: train==[86.64185=-0.08935 + 1.96225 + 75.94275 + 8.82620]
Epoch 36 [15.5s]: train==[86.37298=-0.09004 + 1.93506 + 75.77424 + 8.75372]
Epoch 37 [15.4s]: train==[86.19767=-0.09009 + 1.89942 + 75.71595 + 8.67239]
Epoch 38 [15.5s]: train==[86.30283=-0.09031 + 1.87016 + 75.91247 + 8.61051]
Epoch 39 [15.5s + 8.4s]:, recall=[0.00241, 0.00747], precision=[0.00024, 0.00015], hit=[0.00241, 0.00747], ndcg=[0.00138, 0.00247]
Epoch 40 [15.5s]: train==[85.85893=-0.09120 + 1.81335 + 75.68465 + 8.45215]
Epoch 41 [15.4s]: train==[85.66840=-0.09247 + 1.78466 + 75.59772 + 8.37849]
Epoch 42 [15.5s]: train==[85.34065=-0.09314 + 1.76099 + 75.35580 + 8.31700]
Epoch 43 [15.4s]: train==[85.39753=-0.09240 + 1.73275 + 75.50624 + 8.25094]
Epoch 44 [15.5s + 8.4s]:, recall=[0.00217, 0.00915], precision=[0.00022, 0.00018], hit=[0.00217, 0.00915], ndcg=[0.00131, 0.00280]
Epoch 45 [15.5s]: train==[84.88706=-0.09543 + 1.69082 + 75.16932 + 8.12235]
Epoch 46 [15.4s]: train==[84.94696=-0.09566 + 1.67224 + 75.31832 + 8.05206]
Epoch 47 [15.6s]: train==[84.90842=-0.09836 + 1.65361 + 75.36350 + 7.98967]
Epoch 48 [15.5s]: train==[84.67796=-0.09946 + 1.62704 + 75.22342 + 7.92696]
Epoch 49 [15.4s + 8.1s]:, recall=[0.00205, 0.00819], precision=[0.00020, 0.00016], hit=[0.00205, 0.00819], ndcg=[0.00115, 0.00248]
Epoch 50 [15.5s]: train==[84.42192=-0.10176 + 1.59461 + 75.10981 + 7.81927]
Epoch 51 [15.4s]: train==[84.30516=-0.10454 + 1.57940 + 75.07082 + 7.75948]
Epoch 52 [15.5s]: train==[84.26353=-0.10634 + 1.56473 + 75.09443 + 7.71071]
Epoch 53 [15.5s]: train==[83.94442=-0.10936 + 1.55039 + 74.84912 + 7.65426]
Epoch 54 [15.4s + 8.2s]:, recall=[0.00253, 0.00843], precision=[0.00025, 0.00017], hit=[0.00253, 0.00843], ndcg=[0.00146, 0.00271]
Epoch 55 [15.5s]: train==[83.96288=-0.11269 + 1.51890 + 75.02767 + 7.52900]
Epoch 56 [15.5s]: train==[83.79061=-0.11605 + 1.50538 + 74.92108 + 7.48021]
Epoch 57 [15.4s]: train==[83.78973=-0.11861 + 1.49519 + 74.98062 + 7.43252]
Epoch 58 [15.5s]: train==[83.60961=-0.12223 + 1.48093 + 74.85229 + 7.39862]
Epoch 59 [15.5s + 8.1s]:, recall=[0.00241, 0.00903], precision=[0.00024, 0.00018], hit=[0.00241, 0.00903], ndcg=[0.00131, 0.00271]
Epoch 60 [15.4s]: train==[83.44182=-0.12789 + 1.46184 + 74.82976 + 7.27811]
Epoch 61 [15.5s]: train==[83.46273=-0.13027 + 1.45106 + 74.91168 + 7.23025]
Epoch 62 [15.5s]: train==[83.45994=-0.13677 + 1.44134 + 74.98461 + 7.17076]
Epoch 63 [15.4s]: train==[83.09684=-0.14099 + 1.43197 + 74.65615 + 7.14972]
Epoch 64 [15.5s + 8.2s]:, recall=[0.00301, 0.00879], precision=[0.00030, 0.00018], hit=[0.00301, 0.00879], ndcg=[0.00148, 0.00270]
Epoch 65 [15.4s]: train==[83.03252=-0.14951 + 1.41455 + 74.74096 + 7.02652]
Epoch 66 [15.5s]: train==[82.73715=-0.15460 + 1.40579 + 74.50435 + 6.98161]
Epoch 67 [15.5s]: train==[82.80777=-0.15983 + 1.39899 + 74.62150 + 6.94711]
Epoch 68 [15.4s]: train==[82.79307=-0.16594 + 1.39460 + 74.66744 + 6.89698]
Epoch 69 [15.5s + 8.1s]:, recall=[0.00313, 0.01072], precision=[0.00031, 0.00021], hit=[0.00313, 0.01072], ndcg=[0.00142, 0.00298]
Epoch 70 [15.5s]: train==[82.63006=-0.18144 + 1.38229 + 74.63772 + 6.79148]
Epoch 71 [15.4s]: train==[82.63822=-0.18924 + 1.37698 + 74.70598 + 6.74450]
Epoch 72 [15.5s]: train==[82.44870=-0.19768 + 1.37355 + 74.55737 + 6.71546]
Epoch 73 [15.4s]: train==[82.55328=-0.20815 + 1.37051 + 74.71116 + 6.67975]
Epoch 74 [15.5s + 8.4s]:, recall=[0.00325, 0.01096], precision=[0.00033, 0.00022], hit=[0.00325, 0.01096], ndcg=[0.00175, 0.00340]
Epoch 75 [15.5s]: train==[82.26999=-0.23370 + 1.36859 + 74.54654 + 6.58854]
Epoch 76 [15.5s]: train==[82.33461=-0.24764 + 1.36669 + 74.69073 + 6.52482]
Epoch 77 [15.4s]: train==[82.23054=-0.26200 + 1.36747 + 74.63064 + 6.49442]
Epoch 78 [15.5s]: train==[82.24403=-0.28180 + 1.36925 + 74.69559 + 6.46099]
Epoch 79 [15.4s + 8.3s]:, recall=[0.00373, 0.01337], precision=[0.00037, 0.00027], hit=[0.00373, 0.01337], ndcg=[0.00194, 0.00399]
Epoch 80 [15.5s]: train==[82.14167=-0.32946 + 1.37534 + 74.72565 + 6.37015]
Epoch 81 [15.5s]: train==[81.98118=-0.35684 + 1.38467 + 74.61458 + 6.33877]
Epoch 82 [15.4s]: train==[81.85705=-0.39253 + 1.39243 + 74.53342 + 6.32373]
Epoch 83 [15.4s]: train==[81.81522=-0.43667 + 1.40152 + 74.58184 + 6.26853]
Epoch 84 [15.4s + 8.1s]:, recall=[0.00506, 0.01855], precision=[0.00051, 0.00037], hit=[0.00506, 0.01855], ndcg=[0.00276, 0.00565]
Epoch 85 [15.4s]: train==[81.44417=-0.54818 + 1.43155 + 74.34734 + 6.21346]
Epoch 86 [15.5s]: train==[81.56587=-0.62950 + 1.45607 + 74.55809 + 6.18121]
Epoch 87 [15.4s]: train==[81.44884=-0.73205 + 1.48617 + 74.52414 + 6.17057]
Epoch 88 [15.5s]: train==[81.31901=-0.87300 + 1.52426 + 74.52535 + 6.14241]
Epoch 89 [15.5s + 8.3s]:, recall=[0.01108, 0.03927], precision=[0.00111, 0.00079], hit=[0.01108, 0.03927], ndcg=[0.00597, 0.01196]
Epoch 90 [15.4s]: train==[80.91963=-1.32784 + 1.64202 + 74.46673 + 6.13873]
Epoch 91 [15.5s]: train==[80.68844=-1.71387 + 1.73440 + 74.51375 + 6.15416]
Epoch 92 [15.4s]: train==[80.20371=-2.32467 + 1.86612 + 74.46667 + 6.19560]
Epoch 93 [15.5s]: train==[79.53119=-3.39558 + 2.06097 + 74.57980 + 6.28600]
Epoch 94 [15.5s + 8.1s]:, recall=[0.07131, 0.13985], precision=[0.00713, 0.00280], hit=[0.07131, 0.13985], ndcg=[0.03620, 0.05163]
Epoch 95 [15.5s]: train==[74.83484=-9.49829 + 2.93743 + 74.64065 + 6.75505]
Epoch 96 [15.7s]: train==[65.70159=-20.41693 + 4.06048 + 74.77854 + 7.27950]
Epoch 97 [15.6s]: train==[25.65194=-88.74671 + 10.97659 + 95.68880 + 7.73326]
Epoch 98 [15.5s]: train==[-310.05986=-556.72765 + 60.99636 + 178.88426 + 6.78717]
Epoch 99 [15.7s + 8.2s]:, recall=[0.09347, 0.17092], precision=[0.00935, 0.00342], hit=[0.09347, 0.17092], ndcg=[0.06188, 0.07870]
Epoch 100 [15.4s]: train==[-1945.33836=-2244.63360 + 117.48778 + 170.80721 + 11.00025]
Epoch 101 [15.5s]: train==[-3335.08158=-3645.47810 + 125.72325 + 172.17371 + 12.49953]
Epoch 102 [15.5s]: train==[-4859.54440=-5154.14672 + 121.53969 + 159.36887 + 13.69377]
Epoch 103 [15.5s]: train==[-6776.37837=-7063.78781 + 124.40247 + 148.54144 + 14.46547]
Epoch 104 [15.4s + 8.3s]:, recall=[0.49518, 0.63009], precision=[0.04952, 0.01260], hit=[0.49518, 0.63009], ndcg=[0.35702, 0.38753]
Epoch 105 [15.5s]: train==[-10433.59038=-10705.98038 + 124.68575 + 132.04283 + 15.66129]
Epoch 106 [15.4s]: train==[-12061.49008=-12330.12204 + 125.86772 + 126.96243 + 15.80179]
Epoch 107 [15.5s]: train==[-13432.94580=-13698.85101 + 125.53198 + 124.42261 + 15.95054]
Epoch 108 [15.5s]: train==[-14623.48425=-14886.23370 + 124.62307 + 121.86573 + 16.26060]
Epoch 109 [15.4s + 8.2s]:, recall=[0.59251, 0.70296], precision=[0.05925, 0.01406], hit=[0.59251, 0.70296], ndcg=[0.42527, 0.45085]
Epoch 110 [15.4s]: train==[-16926.84479=-17188.00851 + 124.49813 + 120.25909 + 16.40627]
Epoch 111 [15.5s]: train==[-17864.36682=-18123.02380 + 123.81584 + 118.29187 + 16.54915]
Epoch 112 [15.4s]: train==[-18728.10077=-18987.48407 + 123.33936 + 119.52719 + 16.51671]
Epoch 113 [15.5s]: train==[-19413.07181=-19672.87582 + 123.39755 + 119.83200 + 16.57441]
Epoch 114 [15.4s + 8.2s]:, recall=[0.57528, 0.71055], precision=[0.05753, 0.01421], hit=[0.57528, 0.71055], ndcg=[0.40582, 0.43705]
Epoch 115 [15.5s]: train==[-20849.22662=-21108.63098 + 122.12545 + 120.47162 + 16.80738]
Epoch 116 [15.5s]: train==[-21476.15741=-21734.68054 + 121.75140 + 120.00427 + 16.76775]
Epoch 117 [15.4s]: train==[-21921.36005=-22180.44669 + 121.68914 + 120.57238 + 16.82517]
Epoch 118 [15.4s]: train==[-22546.90540=-22805.79150 + 121.15732 + 120.79849 + 16.93036]
Epoch 119 [15.5s + 8.3s]:, recall=[0.54469, 0.69309], precision=[0.05447, 0.01386], hit=[0.54469, 0.69309], ndcg=[0.38089, 0.41489]
Epoch 120 [15.5s]: train==[-23675.23425=-23935.18311 + 120.49326 + 122.50036 + 16.95515]
Epoch 121 [15.5s]: train==[-24080.01392=-24340.66791 + 120.22080 + 123.32845 + 17.10478]
Epoch 122 [15.4s]: train==[-24514.54932=-24776.34052 + 119.83711 + 124.77632 + 17.17781]
Epoch 123 [15.5s]: train==[-24951.48987=-25213.74481 + 119.47038 + 125.65333 + 17.13120]
Epoch 124 [15.5s + 8.4s]:, recall=[0.51626, 0.66839], precision=[0.05163, 0.01337], hit=[0.51626, 0.66839], ndcg=[0.35682, 0.39167]
Epoch 125 [15.5s]: train==[-25826.45282=-26090.04248 + 118.97730 + 127.34176 + 17.27058]
Epoch 126 [15.4s]: train==[-26135.26422=-26398.96539 + 118.75437 + 127.55286 + 17.39398]
Epoch 127 [15.5s]: train==[-26366.58698=-26629.82898 + 118.46769 + 127.31288 + 17.46137]
Epoch 128 [15.4s]: train==[-26794.45288=-27059.23193 + 118.20805 + 129.08077 + 17.49000]
Epoch 129 [15.5s + 8.3s]:, recall=[0.48747, 0.64888], precision=[0.04875, 0.01298], hit=[0.48747, 0.64888], ndcg=[0.33621, 0.37307]
Epoch 130 [15.5s]: train==[-27505.95667=-27771.35120 + 117.75733 + 130.06360 + 17.57366]
Epoch 131 [15.4s]: train==[-27692.62634=-27959.16412 + 117.44482 + 131.45575 + 17.63744]
Epoch 132 [15.5s]: train==[-28134.80127=-28401.13715 + 117.35244 + 131.32186 + 17.66164]
Epoch 133 [15.5s]: train==[-28282.05878=-28548.26074 + 116.98803 + 131.47657 + 17.73719]
Epoch 134 [15.4s + 8.3s]:, recall=[0.45965, 0.63129], precision=[0.04596, 0.01263], hit=[0.45965, 0.63129], ndcg=[0.31506, 0.35402]
Epoch 135 [15.5s]: train==[-28775.29291=-29043.23779 + 116.56510 + 133.63824 + 17.74164]
Epoch 136 [15.4s]: train==[-29029.16571=-29297.51666 + 116.33686 + 134.21633 + 17.79780]
Epoch 137 [15.5s]: train==[-29265.66675=-29534.31592 + 116.16388 + 134.64827 + 17.83709]
Epoch 138 [15.5s]: train==[-29497.79358=-29766.71118 + 115.95985 + 135.12453 + 17.83345]
Epoch 139 [15.4s + 8.5s]:, recall=[0.43736, 0.61178], precision=[0.04374, 0.01224], hit=[0.43736, 0.61178], ndcg=[0.29776, 0.33719]
Epoch 140 [15.5s]: train==[-29919.13843=-30189.04419 + 115.66022 + 136.34247 + 17.90303]
Epoch 141 [15.4s]: train==[-29940.19269=-30210.57080 + 115.58285 + 136.91340 + 17.88178]
Epoch 142 [15.5s]: train==[-30137.70703=-30408.82574 + 115.18015 + 138.01265 + 17.92599]
Epoch 143 [15.5s]: train==[-30505.07544=-30776.37073 + 115.12267 + 138.22174 + 17.95120]
Epoch 144 [15.5s + 8.4s]:, recall=[0.41906, 0.59419], precision=[0.04191, 0.01188], hit=[0.41906, 0.59419], ndcg=[0.28393, 0.32361]
Epoch 145 [15.4s]: train==[-30788.68744=-31060.56757 + 114.93398 + 138.94627 + 18.00009]
Epoch 146 [15.5s]: train==[-31047.46173=-31319.28131 + 114.57725 + 139.27906 + 17.96312]
Epoch 147 [15.4s]: train==[-31335.93683=-31608.35760 + 114.57526 + 139.81762 + 18.02786]
Epoch 148 [15.5s]: train==[-31352.75165=-31626.11005 + 114.50589 + 140.83660 + 18.01598]
Epoch 149 [15.5s + 8.5s]:, recall=[0.40400, 0.58203], precision=[0.04040, 0.01164], hit=[0.40400, 0.58203], ndcg=[0.27242, 0.31262]
Epoch 150 [15.4s]: train==[-31386.53662=-31661.55518 + 114.29570 + 142.72186 + 18.00082]
Epoch 151 [15.5s]: train==[-31591.97467=-31865.25763 + 113.95201 + 141.29355 + 18.03764]
Epoch 152 [15.5s]: train==[-31858.04407=-32131.51282 + 113.87235 + 141.54550 + 18.05065]
Epoch 153 [15.4s]: train==[-31929.05084=-32203.31445 + 113.77299 + 142.46047 + 18.03023]
Epoch 154 [15.5s + 8.6s]:, recall=[0.39135, 0.57022], precision=[0.03914, 0.01140], hit=[0.39135, 0.57022], ndcg=[0.26204, 0.30228]
Epoch 155 [15.3s]: train==[-32185.69904=-32459.95496 + 113.44456 + 142.75669 + 18.05473]
Epoch 156 [15.5s]: train==[-32292.93427=-32567.68457 + 113.47873 + 143.21948 + 18.05194]
Epoch 157 [15.5s]: train==[-32269.10999=-32544.38257 + 113.25128 + 143.91609 + 18.10528]
Epoch 158 [15.4s]: train==[-32498.06067=-32773.29303 + 113.09926 + 144.05491 + 18.07837]
Epoch 159 [15.4s + 8.4s]:, recall=[0.38159, 0.55926], precision=[0.03816, 0.01119], hit=[0.38159, 0.55926], ndcg=[0.25410, 0.29384]
Early stopping is trigger at step: 10 log:0.3815947964345881
Best Iter=[21]@[2749.0]	recall=[0.5064	0.5925	0.6536	0.7030], ndcg=[0.3973	0.4253	0.4409	0.4509]
Model Save To Tmall.pth.tar
