Dataset name: Tmall
The number of users: 8302
The number of items: 30316
The behavior ratings: [417483, 57409, 43172]
The number of ratings: 518064
Average actions of users: 62.40
Average actions of items: 17.09
The density of the dataset: 0.002058
The sparsity of the dataset: 99.794160%
wid : [0.1,0.1,0.1]
decay: 10.00
coefficient : [0.0/6, 5.0/6, 1.0/6]
already load adj matrix 0.12097883224487305
already load pre adj matrix
use the pre adjcency matrix
638
116
112
user_text_embs.shape: torch.Size([8302, 768])
self.num_users: 8302
without pretraining.
Epoch 0 [16.7s]: train==[805.10062=2.65963 + 156.41973 + 632.18075 + 13.84051]
Epoch 1 [16.5s]: train==[274.07002=0.43803 + 45.50739 + 214.88588 + 13.23871]
Epoch 2 [16.2s]: train==[139.28739=-0.01964 + 21.79750 + 101.27737 + 16.23215]
Epoch 3 [16.5s]: train==[119.08424=-0.07906 + 14.67864 + 87.39651 + 17.08815]
Epoch 4 [16.3s + 13.0s]:, recall=[0.00108, 0.00349], precision=[0.00011, 0.00007], hit=[0.00108, 0.00349], ndcg=[0.00050, 0.00100]
Epoch 5 [16.2s]: train==[107.34404=-0.13867 + 8.41856 + 83.17581 + 15.88834]
Epoch 6 [16.0s]: train==[103.68260=-0.15438 + 6.81917 + 82.23233 + 14.78547]
Epoch 7 [15.9s]: train==[100.88055=-0.16094 + 5.72233 + 81.59399 + 13.72516]
Epoch 8 [15.9s]: train==[98.91914=-0.16280 + 4.92673 + 81.26673 + 12.88847]
Epoch 9 [16.2s + 12.7s]:, recall=[0.00048, 0.00422], precision=[0.00005, 0.00008], hit=[0.00048, 0.00422], ndcg=[0.00035, 0.00113]
Epoch 10 [15.9s]: train==[96.09533=-0.14939 + 3.94753 + 80.48709 + 11.81010]
Epoch 11 [16.3s]: train==[95.03150=-0.13872 + 3.64050 + 80.01264 + 11.51709]
Epoch 12 [16.6s]: train==[94.26646=-0.12921 + 3.42275 + 79.66593 + 11.30698]
Epoch 13 [16.4s]: train==[93.57757=-0.12248 + 3.25222 + 79.27955 + 11.16829]
Epoch 14 [16.7s + 12.5s]:, recall=[0.00072, 0.00626], precision=[0.00007, 0.00013], hit=[0.00072, 0.00626], ndcg=[0.00033, 0.00147]
Epoch 15 [16.3s]: train==[92.48232=-0.11121 + 3.01008 + 78.66788 + 10.91557]
Epoch 16 [16.0s]: train==[92.39318=-0.10745 + 2.91390 + 78.78147 + 10.80526]
Epoch 17 [16.1s]: train==[91.76685=-0.10308 + 2.83548 + 78.35825 + 10.67621]
Epoch 18 [16.0s]: train==[91.59095=-0.10322 + 2.75822 + 78.37982 + 10.55613]
Epoch 19 [16.5s + 12.8s]:, recall=[0.00157, 0.00723], precision=[0.00016, 0.00014], hit=[0.00157, 0.00723], ndcg=[0.00075, 0.00191]
Epoch 20 [16.0s]: train==[90.83855=-0.09914 + 2.63055 + 77.98770 + 10.31944]
Epoch 21 [16.5s]: train==[90.45708=-0.09773 + 2.57796 + 77.78581 + 10.19104]
Epoch 22 [16.5s]: train==[90.13565=-0.09612 + 2.51699 + 77.63668 + 10.07811]
Epoch 23 [16.8s]: train==[89.72349=-0.09440 + 2.47078 + 77.38164 + 9.96546]
Epoch 24 [16.4s + 12.5s]:, recall=[0.00181, 0.00735], precision=[0.00018, 0.00015], hit=[0.00181, 0.00735], ndcg=[0.00102, 0.00219]
Epoch 25 [16.3s]: train==[88.99574=-0.09320 + 2.36420 + 76.95122 + 9.77352]
Epoch 26 [16.6s]: train==[88.82262=-0.09159 + 2.31959 + 76.93827 + 9.65635]
Epoch 27 [16.4s]: train==[88.42769=-0.09205 + 2.27909 + 76.70690 + 9.53375]
Epoch 28 [16.5s]: train==[88.21271=-0.09185 + 2.23045 + 76.63893 + 9.43517]
Epoch 29 [16.3s + 13.2s]:, recall=[0.00229, 0.00855], precision=[0.00023, 0.00017], hit=[0.00229, 0.00855], ndcg=[0.00117, 0.00249]
Epoch 30 [15.9s]: train==[87.92866=-0.09068 + 2.14991 + 76.59940 + 9.27004]
Epoch 31 [16.1s]: train==[87.70706=-0.08947 + 2.11324 + 76.51146 + 9.17183]
Epoch 32 [16.3s]: train==[87.29821=-0.08976 + 2.07021 + 76.23708 + 9.08067]
Epoch 33 [16.3s]: train==[87.11805=-0.09025 + 2.03515 + 76.18263 + 8.99052]
Epoch 34 [16.6s + 12.8s]:, recall=[0.00253, 0.00843], precision=[0.00025, 0.00017], hit=[0.00253, 0.00843], ndcg=[0.00122, 0.00245]
Epoch 35 [16.0s]: train==[86.64324=-0.08927 + 1.96233 + 75.94410 + 8.82607]
Epoch 36 [16.8s]: train==[86.36986=-0.08997 + 1.93491 + 75.77595 + 8.74897]
Epoch 37 [16.6s]: train==[86.20574=-0.09003 + 1.89936 + 75.71743 + 8.67898]
Epoch 38 [16.5s]: train==[86.30352=-0.09025 + 1.87030 + 75.91439 + 8.60909]
Epoch 39 [16.5s + 13.5s]:, recall=[0.00241, 0.00747], precision=[0.00024, 0.00015], hit=[0.00241, 0.00747], ndcg=[0.00138, 0.00246]
Epoch 40 [16.1s]: train==[85.86029=-0.09119 + 1.81374 + 75.68714 + 8.45060]
Epoch 41 [16.2s]: train==[85.66621=-0.09237 + 1.78459 + 75.59912 + 8.37487]
Epoch 42 [16.6s]: train==[85.34459=-0.09305 + 1.76078 + 75.35723 + 8.31962]
Epoch 43 [16.5s]: train==[85.39468=-0.09231 + 1.73271 + 75.50806 + 8.24622]
Epoch 44 [16.6s + 13.0s]:, recall=[0.00217, 0.00940], precision=[0.00022, 0.00019], hit=[0.00217, 0.00940], ndcg=[0.00131, 0.00284]
Epoch 45 [16.3s]: train==[84.88920=-0.09535 + 1.69083 + 75.17062 + 8.12310]
Epoch 46 [16.4s]: train==[84.94706=-0.09556 + 1.67215 + 75.31936 + 8.05110]
Epoch 47 [16.4s]: train==[84.90924=-0.09826 + 1.65364 + 75.36521 + 7.98864]
Epoch 48 [16.8s]: train==[84.68071=-0.09937 + 1.62700 + 75.22456 + 7.92852]
Epoch 49 [16.6s + 13.2s]:, recall=[0.00205, 0.00843], precision=[0.00020, 0.00017], hit=[0.00205, 0.00843], ndcg=[0.00124, 0.00262]
Epoch 50 [16.1s]: train==[84.42199=-0.10162 + 1.59450 + 75.11049 + 7.81862]
Epoch 51 [16.4s]: train==[84.31008=-0.10436 + 1.57925 + 75.07194 + 7.76325]
Epoch 52 [16.3s]: train==[84.26515=-0.10623 + 1.56484 + 75.09506 + 7.71147]
Epoch 53 [16.7s]: train==[83.94848=-0.10922 + 1.55036 + 74.84961 + 7.65772]
Epoch 54 [16.6s + 12.8s]:, recall=[0.00253, 0.00831], precision=[0.00025, 0.00017], hit=[0.00253, 0.00831], ndcg=[0.00147, 0.00270]
Epoch 55 [16.1s]: train==[83.96720=-0.11250 + 1.51898 + 75.02808 + 7.53264]
Epoch 56 [15.9s]: train==[83.79585=-0.11589 + 1.50549 + 74.92198 + 7.48427]
Epoch 57 [15.8s]: train==[83.78670=-0.11843 + 1.49522 + 74.98111 + 7.42880]
Epoch 58 [16.4s]: train==[83.61083=-0.12200 + 1.48118 + 74.85267 + 7.39899]
Epoch 59 [16.5s + 12.3s]:, recall=[0.00241, 0.00964], precision=[0.00024, 0.00019], hit=[0.00241, 0.00964], ndcg=[0.00131, 0.00283]
Epoch 60 [16.0s]: train==[83.44372=-0.12770 + 1.46161 + 74.83051 + 7.27930]
Epoch 61 [16.0s]: train==[83.46524=-0.12999 + 1.45089 + 74.91120 + 7.23315]
Epoch 62 [16.6s]: train==[83.46329=-0.13648 + 1.44100 + 74.98343 + 7.17534]
Epoch 63 [16.0s]: train==[83.10028=-0.14065 + 1.43178 + 74.65700 + 7.15214]
Epoch 64 [16.3s + 12.9s]:, recall=[0.00313, 0.00831], precision=[0.00031, 0.00017], hit=[0.00313, 0.00831], ndcg=[0.00152, 0.00261]
Epoch 65 [16.1s]: train==[83.04161=-0.14911 + 1.41472 + 74.74083 + 7.03517]
Epoch 66 [16.4s]: train==[82.74469=-0.15420 + 1.40571 + 74.50475 + 6.98843]
Epoch 67 [16.0s]: train==[82.81461=-0.15937 + 1.39901 + 74.62194 + 6.95303]
Epoch 68 [15.7s]: train==[82.80090=-0.16553 + 1.39476 + 74.66861 + 6.90307]
Epoch 69 [15.8s + 12.9s]:, recall=[0.00301, 0.01084], precision=[0.00030, 0.00022], hit=[0.00301, 0.01084], ndcg=[0.00141, 0.00302]
Epoch 70 [16.2s]: train==[82.63845=-0.18085 + 1.38208 + 74.63849 + 6.79872]
Epoch 71 [16.3s]: train==[82.65015=-0.18865 + 1.37706 + 74.70692 + 6.75482]
Epoch 72 [16.3s]: train==[82.45354=-0.19705 + 1.37333 + 74.55734 + 6.71991]
Epoch 73 [16.1s]: train==[82.55412=-0.20742 + 1.37046 + 74.71104 + 6.68004]
Epoch 74 [16.6s + 12.7s]:, recall=[0.00325, 0.01144], precision=[0.00033, 0.00023], hit=[0.00325, 0.01144], ndcg=[0.00173, 0.00347]
Epoch 75 [16.3s]: train==[82.27568=-0.23275 + 1.36811 + 74.54506 + 6.59526]
Epoch 76 [16.5s]: train==[82.34563=-0.24649 + 1.36631 + 74.69138 + 6.53444]
Epoch 77 [16.4s]: train==[82.24234=-0.26064 + 1.36728 + 74.63138 + 6.50432]
Epoch 78 [16.6s]: train==[82.25448=-0.28035 + 1.36883 + 74.69606 + 6.46993]
Epoch 79 [16.7s + 12.3s]:, recall=[0.00422, 0.01482], precision=[0.00042, 0.00030], hit=[0.00422, 0.01482], ndcg=[0.00218, 0.00436]
Epoch 80 [16.4s]: train==[82.15292=-0.32766 + 1.37407 + 74.72577 + 6.38074]
Epoch 81 [16.5s]: train==[81.99302=-0.35409 + 1.38425 + 74.61375 + 6.34911]
Epoch 82 [16.2s]: train==[81.86659=-0.39005 + 1.39187 + 74.53387 + 6.33089]
Epoch 83 [16.4s]: train==[81.82546=-0.43333 + 1.40026 + 74.58153 + 6.27701]
Epoch 84 [15.9s + 13.2s]:, recall=[0.00530, 0.01951], precision=[0.00053, 0.00039], hit=[0.00530, 0.01951], ndcg=[0.00277, 0.00581]
Epoch 85 [16.2s]: train==[81.45702=-0.54296 + 1.42967 + 74.34778 + 6.22252]
Epoch 86 [16.6s]: train==[81.57897=-0.62302 + 1.45426 + 74.55714 + 6.19059]
Epoch 87 [16.4s]: train==[81.46238=-0.72362 + 1.48378 + 74.52496 + 6.17726]
Epoch 88 [16.1s]: train==[81.33460=-0.86136 + 1.52051 + 74.52532 + 6.15013]
Epoch 89 [16.2s + 13.2s]:, recall=[0.01132, 0.04047], precision=[0.00113, 0.00081], hit=[0.01132, 0.04047], ndcg=[0.00619, 0.01241]
Epoch 90 [16.1s]: train==[80.94459=-1.30493 + 1.63721 + 74.46664 + 6.14566]
Epoch 91 [16.5s]: train==[80.72041=-1.68075 + 1.72591 + 74.51444 + 6.16082]
Epoch 92 [16.1s]: train==[80.25254=-2.26763 + 1.85375 + 74.46777 + 6.19865]
Epoch 93 [16.5s]: train==[79.61168=-3.29728 + 2.04343 + 74.57953 + 6.28601]
Epoch 94 [16.2s + 12.7s]:, recall=[0.06926, 0.13900], precision=[0.00693, 0.00278], hit=[0.06926, 0.13900], ndcg=[0.03513, 0.05079]
Epoch 95 [15.8s]: train==[75.18863=-9.06751 + 2.88664 + 74.63488 + 6.73461]
Epoch 96 [16.2s]: train==[66.72880=-19.21179 + 3.95201 + 74.75347 + 7.23511]
Epoch 97 [16.7s]: train==[32.48903=-73.83909 + 9.31794 + 89.21271 + 7.79747]
Epoch 98 [16.6s]: train==[-271.59177=-513.99560 + 57.49268 + 178.15299 + 6.75815]
Epoch 99 [16.2s + 12.7s]:, recall=[0.08384, 0.15852], precision=[0.00838, 0.00317], hit=[0.08384, 0.15852], ndcg=[0.05327, 0.06961]
Epoch 100 [15.9s]: train==[-1918.66099=-2210.78093 + 112.74941 + 168.56043 + 10.81011]
Epoch 101 [16.5s]: train==[-3247.53316=-3543.17132 + 114.37929 + 168.57260 + 12.68623]
Epoch 102 [16.3s]: train==[-4800.45205=-5080.86079 + 114.14117 + 152.00334 + 14.26427]
Epoch 103 [16.5s]: train==[-6767.31894=-7045.12700 + 119.86888 + 143.31606 + 14.62314]
Epoch 104 [16.0s + 12.8s]:, recall=[0.47687, 0.63069], precision=[0.04769, 0.01261], hit=[0.47687, 0.63069], ndcg=[0.33246, 0.36756]
Epoch 105 [16.3s]: train==[-10499.29910=-10764.58627 + 121.12641 + 128.72702 + 15.43374]
Epoch 106 [16.0s]: train==[-12133.05103=-12393.18167 + 121.40438 + 122.90145 + 15.82483]
Epoch 107 [16.0s]: train==[-13538.83212=-13797.62143 + 121.75264 + 121.17207 + 15.86458]
Epoch 108 [16.0s]: train==[-14750.69104=-15007.32565 + 121.19833 + 119.39119 + 16.04496]
Epoch 109 [16.2s + 12.6s]:, recall=[0.59203, 0.70525], precision=[0.05920, 0.01411], hit=[0.59203, 0.70525], ndcg=[0.42006, 0.44615]
Epoch 110 [16.0s]: train==[-17104.94592=-17360.06223 + 121.27062 + 117.66970 + 16.17584]
Epoch 111 [16.3s]: train==[-18019.29269=-18273.39981 + 120.70987 + 116.77520 + 16.62226]
Epoch 112 [16.5s]: train==[-18951.26578=-19205.33923 + 120.15770 + 117.33790 + 16.57773]
Epoch 113 [16.6s]: train==[-19668.20593=-19921.75586 + 120.03413 + 116.94126 + 16.57468]
Epoch 114 [16.4s + 13.1s]:, recall=[0.57540, 0.71200], precision=[0.05754, 0.01424], hit=[0.57540, 0.71200], ndcg=[0.40649, 0.43802]
Epoch 115 [16.4s]: train==[-21104.85760=-21359.33423 + 118.76034 + 118.83052 + 16.88601]
Epoch 116 [16.3s]: train==[-21701.19861=-21955.43359 + 118.58522 + 118.72924 + 16.92022]
Epoch 117 [15.9s]: train==[-22233.01855=-22486.60709 + 118.08744 + 118.56537 + 16.93570]
Epoch 118 [16.5s]: train==[-22857.42596=-23111.85590 + 117.90908 + 119.42037 + 17.10052]
Epoch 119 [16.3s + 13.2s]:, recall=[0.54589, 0.69381], precision=[0.05459, 0.01388], hit=[0.54589, 0.69381], ndcg=[0.37981, 0.41354]
Epoch 120 [16.1s]: train==[-24040.10455=-24294.64423 + 117.13214 + 120.30467 + 17.10266]
Epoch 121 [16.5s]: train==[-24427.05389=-24683.11316 + 116.86597 + 121.98818 + 17.20549]
Epoch 122 [16.4s]: train==[-24864.89661=-25122.08173 + 116.56912 + 123.25868 + 17.35732]
Epoch 123 [16.2s]: train==[-25351.42670=-25608.12439 + 116.13085 + 123.25865 + 17.30841]
Epoch 124 [16.0s + 12.8s]:, recall=[0.51036, 0.66912], precision=[0.05104, 0.01338], hit=[0.51036, 0.66912], ndcg=[0.35333, 0.38963]
Epoch 125 [16.2s]: train==[-26154.96979=-26414.44061 + 115.69968 + 126.25863 + 17.51294]
Epoch 126 [15.8s]: train==[-26445.90204=-26706.05878 + 115.52558 + 127.10197 + 17.52915]
Epoch 127 [16.1s]: train==[-26711.70355=-26971.48401 + 115.23768 + 126.87403 + 17.66846]
Epoch 128 [16.1s]: train==[-27169.31989=-27429.95587 + 114.93655 + 128.04445 + 17.65533]
Epoch 129 [15.9s + 12.9s]:, recall=[0.48085, 0.64539], precision=[0.04808, 0.01291], hit=[0.48085, 0.64539], ndcg=[0.33114, 0.36863]
Epoch 130 [15.9s]: train==[-27855.57538=-28117.20758 + 114.56648 + 129.40958 + 17.65643]
Epoch 131 [16.1s]: train==[-28022.36615=-28284.58850 + 114.34618 + 130.18893 + 17.68772]
Epoch 132 [16.2s]: train==[-28495.69763=-28758.36536 + 114.13861 + 130.78274 + 17.74629]
Epoch 133 [16.6s]: train==[-28615.63495=-28878.27106 + 113.86510 + 131.03194 + 17.73886]
Epoch 134 [15.9s + 13.0s]:, recall=[0.45676, 0.62816], precision=[0.04568, 0.01256], hit=[0.45676, 0.62816], ndcg=[0.31169, 0.35052]
Epoch 135 [15.9s]: train==[-29120.19415=-29384.77863 + 113.50217 + 133.25250 + 17.82968]
Epoch 136 [15.9s]: train==[-29368.19794=-29633.28009 + 113.23713 + 134.01457 + 17.83019]
Epoch 137 [16.5s]: train==[-29590.00793=-29855.00867 + 113.11846 + 133.98632 + 17.89589]
Epoch 138 [16.5s]: train==[-29797.52643=-30062.79218 + 112.87516 + 134.55114 + 17.83933]
Epoch 139 [16.4s + 12.6s]:, recall=[0.42845, 0.60793], precision=[0.04285, 0.01216], hit=[0.42845, 0.60793], ndcg=[0.29351, 0.33425]
Epoch 140 [16.0s]: train==[-30208.93909=-30476.42078 + 112.70440 + 136.82990 + 17.94753]
Epoch 141 [16.1s]: train==[-30221.06140=-30488.77716 + 112.63922 + 137.13984 + 17.93652]
Epoch 142 [16.2s]: train==[-30442.87653=-30711.17517 + 112.37816 + 137.96803 + 17.95261]
Epoch 143 [16.1s]: train==[-30773.46143=-31042.04382 + 112.24640 + 138.38060 + 17.95530]
Epoch 144 [16.3s + 13.0s]:, recall=[0.41351, 0.59239], precision=[0.04135, 0.01185], hit=[0.41351, 0.59239], ndcg=[0.28138, 0.32190]
Epoch 145 [15.8s]: train==[-31077.45245=-31345.84680 + 111.92746 + 138.48054 + 17.98616]
Epoch 146 [16.2s]: train==[-31301.26410=-31570.63123 + 111.71140 + 139.67320 + 17.98276]
Epoch 147 [16.1s]: train==[-31645.69873=-31914.60486 + 111.66156 + 139.20939 + 18.03500]
Epoch 148 [16.2s]: train==[-31667.55609=-31937.38037 + 111.54895 + 140.29105 + 17.98452]
Epoch 149 [16.0s + 13.1s]:, recall=[0.40026, 0.57854], precision=[0.04003, 0.01157], hit=[0.40026, 0.57854], ndcg=[0.27061, 0.31076]
Epoch 150 [16.2s]: train==[-31667.81830=-31938.82550 + 111.28923 + 141.66945 + 18.04831]
Epoch 151 [16.5s]: train==[-31864.13708=-32134.70459 + 111.22044 + 141.32783 + 18.01950]
Epoch 152 [16.1s]: train==[-32153.79510=-32423.52319 + 110.95950 + 140.71251 + 18.05620]
Epoch 153 [16.5s]: train==[-32230.97504=-32501.53442 + 110.83471 + 141.66278 + 18.06206]
Epoch 154 [16.8s + 13.0s]:, recall=[0.38665, 0.56697], precision=[0.03867, 0.01134], hit=[0.38665, 0.56697], ndcg=[0.25974, 0.30025]
Epoch 155 [16.1s]: train==[-32439.72095=-32710.77753 + 110.54735 + 142.45434 + 18.05479]
Epoch 156 [16.0s]: train==[-32514.25983=-32786.74756 + 110.66484 + 143.77583 + 18.04753]
Epoch 157 [16.6s]: train==[-32506.50146=-32778.52625 + 110.39787 + 143.57199 + 18.05515]
Epoch 158 [16.1s]: train==[-32761.09149=-33032.68738 + 110.27512 + 143.24393 + 18.07691]
Epoch 159 [16.3s + 13.0s]:, recall=[0.37569, 0.55505], precision=[0.03757, 0.01110], hit=[0.37569, 0.55505], ndcg=[0.25078, 0.29112]
Early stopping is trigger at step: 10 log:0.37569260419175515
Best Iter=[21]@[3027.5]	recall=[0.4988	0.5920	0.6526	0.7053], ndcg=[0.3898	0.4201	0.4355	0.4462]
Model Save To Tmall.pth.tar
